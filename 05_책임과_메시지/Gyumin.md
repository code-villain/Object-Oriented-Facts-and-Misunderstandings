# 객체지향의 사실과 오해

## **05** 책임과 메시지

- 훌륭한 객체지향의 세계는 **명확하게 정의된 역할과 책임**을 지닌 객체들이 **상호 협력**하는 세계다.

---
- 책임-주도 설계
  - **적절한 책임**의 선택이 전체 설계의 방향을 결정한다!
- 객체에게 할당되는 책임이 자율적(= 적절한 책임) → 자율적인 객체 → (자율적인 객체들이 모여) 유연하고 단순한 협력
- ![image](https://user-images.githubusercontent.com/26949964/69916920-2ff50400-14a4-11ea-8d66-5da8432fd175.png)
  - '증언하라'라는 메시지(요청)는 모자 장수가 협력에 참여하는 의도를 명확히 드러내면서도 적당히 추상적이다.
  - 증언하는 구체적인 방법이나 행동들은 모자 장수가 **자율적**으로 결정한다. 모자 장수는 단지 '증언'이라는 책임만 완수할 수 있으면 된다.
- ![image](https://user-images.githubusercontent.com/26949964/69916927-4733f180-14a4-11ea-83d6-a76e7abdb1ea.png)
  - 모자 장수가 증언하는 데 필요한 행동들을 왕이 상세하게 요청하고 있다. (상세한 수준의 책임; 타율적)
  - 따라서 모자 장수가 가진 권한은 축소되고, 선택의 자유가 크게 훼손된다.
- 객체가 자율적이려면, 객체에게 할당되는 책임의 수준도 자율적이어야 한다.
  - 단, 책임은 협력에 참여하는 의도를 명확하게 설명할 수 있는 수준 안에서 추상적이어야 한다.
- 어떤 책임이 자율적인지를 판단하는 기준은 '**문맥**'에 따라 다르다. 즉 어떤 책임이 가장 적절한가는 **협력**이 무엇인가에 따라 달라진다.
- 자율적인 책임은 ~~어떻게(how)~~가 아니라 **무엇(what)**을 해야 하는가를 설명한다.

- 객체가 다른 객체에 접근할 수 있는 유일한 방법은 바로 '메시지-전송 매커니즘'
  - 메시지 전송 — 수신자  
    ⠀⠀⠀⠀⠀⠀ ⠀— 메시지 — 메시지 이름  
    ⠀⠀⠀⠀⠀⠀⠀  ⠀⠀⠀⠀⠀⠀— 인자
  - 메시지 전송은 수신자, 메시지 이름, 인자의 조합으로 구성된다.
  - ex) `모자장수.증언하라(어제, 왕국)`
- 객체가 수신할 수 있는 메시지의 모양이 객체가 수행할 책임의 모양을 결정한다.
- 객체 자신이 수신할 메시지를 변경하지만 않는다면, 그 책임을 수행할 방법을 변경해도 상관 없다. 즉 **객체의 외부와 내부가 메시지를 기준으로 분리**된다.
  - 객체가 제공하는 '메시지'는 공개된 영역, 책임을 수행하는 '방법(메서드)'은 사적인 영역이다.
- 메시지를 수신한 객체가 실행 시간에 메서드를 선택할 수 있다
  - 다른 프로그래밍 패러다임과 객체지향을 구분 짓는 핵심적인 특징

---
### 다형성
- 서로 다른 유형의 객체가 동일한 메시지에 대해 서로 다르게 반응하는 것
- 서로 다른 타입에 속하는 객체들이 동일한 메시지를 수신할 경우, 서로 다른 메서드를 이용해 메시지를 처리할 수 있는 매커니즘
- 하나의 **메시지**와, 하나 이상의 **메서드** 사이의 관계
- 서로 다른 객체들이 다형성을 만족시킨다  
= (메시지 송신자의 관점에서) 동일한 역할을 수행하는 다양한 타입의 객체와 협력할 수 있게 됨 (대체 가능성)  
= 수신자의 종류를 캡슐화한다 (인터페이스에게 메시지 전송 가능)
  - 협력이 유연해짐 / 협력이 수행되는 방식을 확장 가능 / 협력이 수행되는 방식 재사용

---
### 책임-주도 설계
- 객체들 간에 주고받는 메시지를 기반으로 적절한 역할과 책임, 협력을 발견
- 메시지가 수신자의 책임을 결정한다.

### What/Who 사이클
- 어떤 행위(what)가 필요한지를 먼저 결정 -> 그 행위를 수행할 객체(who)를 결정
- (협력이라는 문맥 안에서) 필요한 메시지를 먼저 결정  
  → 메시지를 수신하기에 적합한 객체를 선택  
  → 수신된 메시지가 객체의 책임을 결정
- 객체가 어떤 메시지를 수신하고 처리할 수 있느냐가 객체의 책임을 결정한다.
- 메시지를 먼저 결정함으로써 객체의 인터페이스를 발견할 수 있다.

### Tell, Don't Ask
- 모든 객체는 자신의 상태를 기반으로 스스로 결정을 내려야 한다.
- 객체는 다른 객체의 상태를 묻지 말아야 한다.