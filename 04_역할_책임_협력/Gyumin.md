# 객체지향의 사실과 오해

## **04** 역할, 책임, 협력

- 객체지향 설계의 전체적인 품질은 ~~개별 객체의 품질~~이 아니라, 여러 객체들이 모여 이뤄내는 **협력의 품질**이다.
- 어떤 **협력**에 참여하는가? → 객체마다 필요한 **행동** 결정 → 해당 객체의 **상태** 결정

- 객체지향 애플리케이션의 협력이란, 애플리케이션의 목적 혹은 목표하는 기능 정도로 생각하면 될 듯하다.  
물론 '목적'과 '협력'이라는 단어가 동일한 의미는 아니더라도, '협력을 먼저 생각하라'는 말은 곧 애플리케이션이 수행하고자 하는 기능이나 목표를 먼저 생각하라는 의미로 받아들이면 될 것 같다.
  - 협력을 설계한다는 것은, 협력에 참여하는 객체들이 주고받을 요청과 응답의 흐름을 결정하는 것

- 협력은 다수의 연쇄적인 요청과 응답의 흐름으로 구성된다.  
이 요청과 응답이 협력에 참여하는 개별 객체가 수행할 책임을 정의한다. 어떤 요청을 받아들이고 적절한 방식으로 응답하는 데 필요한 지식과 행동 방식을 갖고 있는 객체가 그 책임을 수행하는 것이 마땅한 것이다.

---
### 책임

- 어떤 객체에게 뭔가 요청(메시지 전송; message-send)을 한다는 것은, 해당 객체가 그 요청을 처리할 책임이 있기 때문이다.
- > 책임을 능숙하게 소프트웨어 객체에 할당하라 — Craig Larman
- **어떤 책임을 수행할 것인가(WHAT)를 먼저 고민**해야 한다.  
개별 객체들과 적절한 책임이 자리잡은 후에, 어떻게 구현할 것인가(HOW)를 고민하자.
  - 설계 초반에는 어떤 객체가 어떤 책임을 가질 것인지, 어떤 객체로부터 메시지를 수신할 것인지 등 개요를 결정하기만 해도 충분하다.
- 책임이란, 객체에 의해 정의되는 응집도 있는 행위의 집합이다.  
객체가 알아야 하는 **정보**와 객체가 (협력에 참여하기 위해)수행할 수 있는 **행위**에 대해 상위 수준에서 개략적으로 서술한 문장이다.
  - 협력을 정제하면서 책임을 메시지로 변환할 때는 하나의 책임이 여러 메시지로 분할되는 것이 일반적
- Craig Larman의 객체의 책임에 대한 2가지 분류('하는 것'과 '아는 것')는 잘 와닿지 않는다...
  - 책임은 객체의 외부에 제공해 줄 수 있는 정보(아는 것)와 외부에 제공해 줄 수 있는 서비스(하는 것)의 목록이라고 한다.

---
### 역할

- 어떤 객체가 수행하는 **책임의 집합**은, 객체가 협력 안에서 수행하는 **역할**을 암시한다.
- 역할은 (협력 내에서) 다른 객체로 대체할 수 있음을 나타내는 표식이며, 역할을 이용하면 여러 협력을 모두 포괄할 수 있는 하나의 협력으로 '**추상화(단순화)**'할 수 있다.
  - ![image](https://user-images.githubusercontent.com/26949964/69637919-018ab980-109d-11ea-8079-a108139fef10.png)
  - ![image](https://user-images.githubusercontent.com/26949964/69637979-1d8e5b00-109d-11ea-8f74-ad522482f3a3.png)
- 단, 역할을 대체할 수 있는 객체는 해당 역할이 수신하는 메시지를 동일한 방식으로 이해할 수 있어야 한다(행동이 호환돼야 한다).
  - 동일한 역할을 수행하는 객체들  
  = 동일한 메시지를 수신할 수 있음  
  = 동일한 책임을 수행
  - 역할에 주어진 책임보다 더 많은 책임을 가질 수도 있다.
    - 일반화/특수화 관계
- 역할의 가치
  - 유사한 협력을 추상화할 수 있다.
  - 다양한 객체들이 협력에 참여할 수 있도록 하므로, 협력이 유연해지고 재사용성이 높아진다.
  - 협력에 참여하는 구체적인 객체를 추상적인 역할로 대체 -> 협력을 단순화(추상화)

---
### 객체의 모양을 결정하는 협력

- 클래스는 객체를 표현하고 생성하기 위해 필요한 도구일 뿐! 언어적으로 제공되는 수단일 뿐이다.
- '클래스를 어떻게 구현할까'가 아니라 객체가 협력 안에서 어떤 책임과 역할을 수행할 것인지를 정하자.
- 협력이라는 문맥을 고려하지 않은 채 각 객체를 독립적으로 바라보면 안된다.
  - 문맥을 고려하고, 해당 문맥에 적합한 책임을 결정하자.
- 객체들이 주고받을 요청과 응답의 흐름 정함  
→ 객체에게 책임 할당(= 외부에 제공할 행동)  
→ 그 행동을 수행하는 데 필요한 데이터 결정  
→ 클래스 구현 방법 결정

- 역할, 책임, 협력은 견고하고 유연한 객체지향 설계를 낳기 위한 가장 중요한 토양
- 역할, 책임, 협력의 관점에서 애플리케이션을 설계하는 3가지 기법
  - 책임-주도 설계
  - 디자인 패턴
  - TDD
    - TDD의 핵심은 테스트 작성이 아니라, 구체적인 코드를 작성해 나가면서 역할, 책임, 협력을 식별하고 그것들이 적합한지를 피드백받는 것이다.